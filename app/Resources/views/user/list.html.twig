{% extends 'base.html.twig' %}
{% import ':Macro:alerts.html.twig'  as alerts      %}
{% import ':Macro:buttons.html.twig' as buttons     %}
{% import ':Macro:misc.html.twig'    as misc        %}

{% block header %}
    <h1>
        Gestion des utilisateurs
    </h1>
{% endblock %}

{% block content %}
	{% embed 'Embed/box.html.twig' %}
        {% block title %}
            <i class="fa fa-list"></i>
            Liste des utilisateurs
        {% endblock %}

        {% block boxContent %}
			<div class="container">
				<div class="row">
					<div class="col-sm-12">
						<div class="col-sm-6">
							{% import ':Macro:buttons.html.twig' as buttons %}
							<div style="z-index:1000;">
								{{ buttons.create({
									url: path('user_create')
								}) }}
							</div>
						</div>
						<div class="col-sm-6">
							
						</div>
					</div>
				</div>
			</div>
            

            <table id="example" class="table table-striped table-bordered" style="width:100%">
				<thead>
					<tr>
						<th>Nom</th>
						<th>Pr√©nom</th>
						<th>Email</th>
						<th>Actif</th>
						<th>Last login</th>
						<th></th>
					</tr>
				</thead>
				{% for user in users %}
					<tr>
						<td>{{ user.lastname|e }}&nbsp;</td>
						<td>{{ user.firstname|e }}&nbsp;</td>
						<td>{{ user.email }}</td>
						<td>{{ misc.state_label(user.enabled) }}</td>
						<td>{{ user.lastLogin|date('d/m/Y') }}</td>
						<td>
							{{ buttons.update({ url :path('user_update', {'id': user.id}) }) }}
							{{ buttons.delete({ url: path('user_delete', {'id': user.id}) }) }}
						</td>
					</tr>
					
				{% endfor %}
				
			</table>
        {% endblock %}
    {% endembed %}
	
	
	
{% endblock %}

{% block stylesheets %}
{{ parent() }}
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.18/af-2.3.3/b-1.5.6/b-colvis-1.5.6/b-flash-1.5.6/b-html5-1.5.6/b-print-1.5.6/cr-1.5.0/fc-3.2.5/fh-3.1.4/kt-2.5.0/r-2.2.2/rg-1.1.0/rr-1.2.4/sc-2.0.0/sl-1.3.0/datatables.min.css"/>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.18/af-2.3.3/b-1.5.6/b-colvis-1.5.6/b-flash-1.5.6/b-html5-1.5.6/b-print-1.5.6/cr-1.5.0/fc-3.2.5/fh-3.1.4/kt-2.5.0/r-2.2.2/rg-1.1.0/rr-1.2.4/sc-2.0.0/sl-1.3.0/datatables.min.js"></script>
	
    <script >
	$(document).ready(function() {
    $('#example').DataTable( {
					responsive: true,
					language: {
									url: '//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json'
								}
				} );
	
	var deleteButton;

			$('.btn-confirm').click(function(e) {
				e.preventDefault();

				deleteButton = $(this);

				if (deleteButton.is("a")) {
					$('#confirmation-modal #confirmation-modal-confirm').attr('href', deleteButton.attr('href'));
				}

				$('#confirmation-modal').modal('show');
			});

			$('#confirmation-modal #confirmation-modal-confirm').click(function(e) {
				if (deleteButton.is("button")) {
					e.preventDefault();
					deleteButton.closest('form').submit();
				}

				if (deleteButton.is("a")) {
					window.location.href = $(this).attr('href');
				}
			});
} );
	</script>
	
    
{% endblock %}